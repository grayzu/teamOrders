var shockInfo = [
        {
            "Bike": "V10C 26in",
            "Bike travel": "8.5/10",
            "Tune": "M/M",
            "Air can": "(vivid only) ",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 9.45,
            "Stroke": 2.99,
            "E2E mm": 240,
            "Stroke mm": 76,
            "Leverage Ratio": "3.6:1"
        },
        {
            "Bike": "V10c 650B",
            "Bike travel": "216mm",
            "Tune": "M/M",
            "Air can": "(vivid only) ",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 8.74,
            "Stroke": 2.76,
            "E2E mm": 222,
            "Stroke mm": 70,
            "Leverage Ratio": ""
        },
        {
            "Bike": "Nomad 1",
            "Bike travel": "165mm",
            "Tune": "M/M",
            "Air can": "DebonAir",
            "Upper and Lower hardware": "3/8 x22mm",
            "Eye to eye": 8.5,
            "Stroke": 2.48,
            "E2E mm": 216,
            "Stroke mm": 63,
            "Leverage Ratio": "2.6:1"
        },
        {
            "Bike": "Nomad 2",
            "Bike travel": "165mm",
            "Tune": "M/M",
            "Air can": "DebonAir",
            "Upper and Lower hardware": "8 x22mm",
            "Eye to eye": 8.5,
            "Stroke": 2.48,
            "E2E mm": 216,
            "Stroke mm": 63,
            "Leverage Ratio": "2.54:1"
        },
        {
            "Bike": "Nomad 3",
            "Bike travel": "165mm",
            "Tune": "M/M",
            "Air can": "DebonAir",
            "Upper and Lower hardware": "8 x22mm",
            "Eye to eye": 8.5,
            "Stroke": 2.48,
            "E2E mm": 216,
            "Stroke mm": 63,
            "Leverage Ratio": "2.6:1"
        },
        {
            "Bike": "Bronson (all)",
            "Bike travel": "150mm",
            "Tune": "M/M",
            "Air can": "DebonAir",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 7.87,
            "Stroke": 2.24,
            "E2E mm": 200,
            "Stroke mm": 57,
            "Leverage Ratio": "2.63:1"
        },
        {
            "Bike": "Tallboy",
            "Bike travel": "100mm",
            "Tune": "M/M",
            "Air can": "Standard Solo Air",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 6.5,
            "Stroke": 1.5,
            "E2E mm": 165,
            "Stroke mm": 38,
            "Leverage Ratio": "2.63:1"
        },
        {
            "Bike": "d8",
            "Bike travel": "8",
            "Tune": "M/M",
            "Air can": "DebonAir",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 8.75,
            "Stroke": 2.75,
            "E2E mm": 222.25,
            "Stroke mm": 69.85,
            "Leverage Ratio": "2.9:1"
        },
        {
            "Bike": "aluminum V10",
            "Bike travel": "8.5/10",
            "Tune": "M/M",
            "Air can": "(vivid only) ",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 8.75,
            "Stroke": 2.75,
            "E2E mm": 222.25,
            "Stroke mm": 69.85,
            "Leverage Ratio": "3.6:1"
        },
        {
            "Bike": "Tallboy 3",
            "Bike travel": "110mm",
            "Tune": "M/M",
            "Air can": "Standard Solo Air",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 7.25,
            "Stroke": 1.75,
            "E2E mm": "??",
            "Stroke mm": "??",
            "Leverage Ratio": ""
        },
        {
            "Bike": "Tallboy LT",
            "Bike travel": "135mm",
            "Tune": "M/M",
            "Air can": "Standard Solo Air or Debonair",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 7.87,
            "Stroke": 2.01,
            "E2E mm": 200,
            "Stroke mm": 51,
            "Leverage Ratio": "2.7:1"
        },
        {
            "Bike": "Hightower",
            "Bike travel": "135mm",
            "Tune": "M/M",
            "Air can": "Standard Solo Air or Debonair",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 7.87,
            "Stroke": 2.01,
            "E2E mm": 200,
            "Stroke mm": 51,
            "Leverage Ratio": ""
        },
        {
            "Bike": "5010",
            "Bike travel": "130mm",
            "Tune": "M/M",
            "Air can": "Standard Solo Air or Debonair",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 7.87,
            "Stroke": 2.01,
            "E2E mm": 200,
            "Stroke mm": 51,
            "Leverage Ratio": "2.5:1"
        },
        {
            "Bike": "Solo",
            "Bike travel": "130mm",
            "Tune": "M/M",
            "Air can": "Standard Solo Air or Debonair",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 7.87,
            "Stroke": 2.01,
            "E2E mm": 200,
            "Stroke mm": 51,
            "Leverage Ratio": ""
        },
        {
            "Bike": "Blur LT 1",
            "Bike travel": "150mm",
            "Tune": "M/M",
            "Air can": "Standard Solo Air or Debonair",
            "Upper and Lower hardware": "8 x22",
            "Eye to eye": 7.87,
            "Stroke": 2.01,
            "E2E mm": 200,
            "Stroke mm": 51,
            "Leverage Ratio": "2.36:1"
        },
        {
            "Bike": "Blur LT 2 2008-2012",
            "Bike travel": "150mm",
            "Tune": "M/M",
            "Air can": "Standard Solo Air or Debonair",
            "Upper and Lower hardware": "9 x22",
            "Eye to eye": 8.5,
            "Stroke": 2.5,
            "E2E mm": "??",
            "Stroke mm": "??",
            "Leverage Ratio": "2.2:1"
        }
    ]

Template.genericModalDialog.helpers({
    shockInfo: shockInfo
});

Template.genericModalDialog.events({
    'click .AddtoCart': function(evt, tmpl){
        //validate all fields are not empty
        var bikeModel = tmpl.$("#customizeBike").is(':checked')? tmpl.$('#customBikeModel').val() : tmpl.$("#bikeModel option:selected").val();
        var e2e = tmpl.$('#e2e').val();
        var stroke = tmpl.$('#stroke').val();
        var tune = tmpl.$('#tune').val();
        var airCan = tmpl.$('#airCan').val();
        var volumespacer = tmpl.$('#volumespacer').val();
        var upperhardware = tmpl.$('#upperhardware').val();
        var lowerhardware = tmpl.$('#lowerhardware').val();
        var coilspring = tmpl.$('#coilspring').val();
        var leverageratio = tmpl.$('#leverageratio').val();
        var averageleverageratio = tmpl.$('#averageleverageratio').val();
        var leverageratiosag = tmpl.$('#leverageratiosag').val();

        var additionalData = {bikeModel: bikeModel, e2e: e2e, stroke: stroke, tune: tune, airCan: airCan, volumespacer: volumespacer, upperhardware: upperhardware, lowerhardware: lowerhardware, coilspring: coilspring, leverageratio: leverageratio, averageleverageratio: averageleverageratio, leverageratiosag: leverageratiosag};
    
        if(bikeModel.length === 0 || e2e.length === 0 || stroke.length === 0 || tune.length === 0 || airCan.length === 0 || volumespacer.length === 0 || upperhardware.length === 0 || lowerhardware.length === 0 || coilspring.length === 0 || leverageratio.length === 0 || averageleverageratio.length === 0 | leverageratiosag.length === 0) {
            alert('Please fill in all of the fields in the template.');
        }
        else{
            var itemData = tmpl.data.data;
            // console.log(itemData);
            // console.log(tmpl.data.qty);
            Meteor.call('Product.AddtoCart',itemData._id, itemData.SKU, itemData.Description, tmpl.data.qty, additionalData);
            Modal.hide();
        }
        
    },
    'change #bikeModel': function(evt, tmpl){
        var selectedBike = shockInfo.find(function(item){return item.Bike === evt.currentTarget.value;});
        tmpl.$('#e2e').val(`${selectedBike["E2E mm"]}mm / ${selectedBike["Eye to eye"]}"`);
        tmpl.$('#stroke').val(`${selectedBike["Stroke mm"]}mm / ${selectedBike.Stroke}"`);
        tmpl.$('#tune').val(selectedBike.Tune);
        tmpl.$('#airCan').val(selectedBike["Air can"]);
        tmpl.$('#volumespacer').val("unknown");
        tmpl.$('#upperhardware').val(selectedBike["Upper and Lower hardware"]);
        tmpl.$('#lowerhardware').val(selectedBike["Upper and Lower hardware"]);
        tmpl.$('#coilspring').attr("placeholder", "Spring wieght (in lbs) or N/A");
        tmpl.$('#leverageratio').val(selectedBike["Leverage Ratio"]);
        tmpl.$('#averageleverageratio').val("unknown");
        tmpl.$('#leverageratiosag').val("unknown");
    },
    'change #customizeBike': function(evt, tmpl){
        $("#customBikeModel").toggleClass("visible hidden");
        $("#bikeModel").toggleClass("visible hidden");
    }
}); 